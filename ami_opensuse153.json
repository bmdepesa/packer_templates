{
    "variables": {
      "name": "opensuse-leap-15.3-docker-20.10.6-gp2",
      "source_ami": "ami-0f0a403b0c7f19d12",
      "access_key":"",
      "secret_key":"",
      "region":"us-east-2"
    },
    "builders": [{
      "type": "amazon-ebs",
      "access_key": "{{user `access_key`}}",
      "secret_key":"{{user `secret_key`}}",
      "ami_name": "{{user `name`}}",
      "region": "{{user `region`}}",
      "ami_regions": [
        "us-east-2"
      ],
      "launch_block_device_mappings": [
        {
          "device_name": "/dev/sda1",
          "volume_size": 12,
          "volume_type": "gp2",
          "delete_on_termination": true
        }
      ],
      "source_ami": "{{user `source_ami`}}",
      "instance_type": "t2.medium",
      "communicator": "ssh",
      "ssh_username": "ec2-user",
      "force_deregister": true,
      "run_tags":{"Name":"packer-image"}
    }],
    "provisioners": [
        {
            "type": "shell",
            "inline": ["sudo zypper -n ref && sudo zypper -n up --no-recommends"]
        },
        {
            "type": "shell",
            "inline": ["sudo usermod -aG docker ec2-user"]
        },
	{
            "type": "shell",
            "inline": ["sudo systemctl enable --now docker"]
        }

]
  }
